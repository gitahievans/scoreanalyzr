(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[994],{755:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var s=(0,r(86467).A)("outline","plus","IconPlus",[["path",{d:"M12 5l0 14",key:"svg-0"}],["path",{d:"M5 12l14 0",key:"svg-1"}]])},4146:(e,t,r)=>{"use strict";r.d(t,{CloseIcon:()=>a});var s=r(95155);let a=(0,r(12115).forwardRef)((e,t)=>{let{size:r="var(--cb-icon-size, 70%)",style:a,...o}=e;return(0,s.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...a,width:r,height:r},ref:t,...o,children:(0,s.jsx)("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})});a.displayName="@mantine/core/CloseIcon"},30285:(e,t,r)=>{"use strict";r.d(t,{$:()=>c});var s=r(95155),a=r(12115),o=r(99708),l=r(74466),n=r(59434);let i=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,t)=>{let{className:r,variant:a,size:l,asChild:c=!1,...d}=e,u=c?o.DX:"button";return(0,s.jsx)(u,{className:(0,n.cn)(i({variant:a,size:l,className:r})),ref:t,...d})});c.displayName="Button"},33273:(e,t,r)=>{"use strict";r.d(t,{default:()=>v});var s=r(95155),a=r(12115),o=r(5041),l=r(6942),n=r(38280),i=r(54395),c=r(26884),d=r(755),u=r(18999),m=r(74634),p=r(59434);let f=a.forwardRef((e,t)=>{let{className:r,type:a,...o}=e;return(0,s.jsx)("input",{type:a,className:(0,p.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...o})});f.displayName="Input";var g=r(30285),h=r(85057);let x=async e=>{let t=new FormData;t.append("title",e.title),t.append("composer",e.composer||"Anonymous"),t.append("lyrics",e.lyrics),e.file&&t.append("file",e.file),e.year&&t.append("year",e.year.toString()),t.append("categories",JSON.stringify(e.categories.map(e=>({name:e})))),t.append("analyze","false");let r=await fetch("".concat("https://api.notadb.xyz:8443","/api/upload/"),{method:"POST",body:t});if(!r.ok)throw Error((await r.json()).message||"Failed to upload file");return r.json()};function v(){var e;let[t,r]=(0,a.useState)([]),[p,v]=(0,a.useState)([]),[y,b]=(0,a.useState)(""),[j,w]=(0,a.useState)(!1),[N,C]=(0,a.useState)({title:"",composer:"",lyrics:"",file:null,categories:[],year:null}),k=(0,u.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat("https://api.notadb.xyz:8443","/api/categories/"));if(!e.ok)throw Error("Failed to fetch categories");let t=await e.json();v(t)}catch(e){}})()},[]);let{mutate:S,isPending:A,error:z}=(0,o.n)({mutationFn:x,onSuccess:e=>{l.$e.show({title:"Success",message:e.message||"File uploaded successfully",color:"green",icon:(0,s.jsx)(n.A,{}),position:"top-center"}),C({title:"",composer:"",lyrics:"",file:null,categories:[],year:null}),r([]),k.push("/notadb")},onError:e=>{l.$e.show({title:"Error",message:e.message,color:"red",icon:(0,s.jsx)(i.A,{}),position:"top-center"})}}),_=e=>{let{name:t,value:r}=e.target;C(e=>({...e,[t]:"year"===t?r?Number(r):null:r}))},F=e=>{let t=e.filter(e=>"application/pdf"===e.type);if(t.length!==e.length){l.$e.show({title:"Error",message:"Only PDF files can be uploaded.",color:"red",icon:(0,s.jsx)(i.A,{})});return}r([t[0]]),C(e=>({...e,file:t[0]}))},B=e=>{C(t=>{let r=t.categories.includes(e)?t.categories.filter(t=>t!==e):[...t.categories,e];return{...t,categories:r}})},E=Array.from({length:new Date().getFullYear()-1900+1},(e,t)=>1900+t);return(0,s.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-orange-600 mb-2",children:"Upload New Music Score"}),(0,s.jsx)("h4",{className:"text-gray-600",children:"Share your musical masterpiece with the world!"})]}),(0,s.jsx)("form",{onSubmit:e=>{e.preventDefault(),N.file&&N.title.trim()&&S(N)},className:"space-y-6",children:(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(h.J,{htmlFor:"title",children:"Title"}),(0,s.jsx)(f,{name:"title",value:N.title,onChange:_,placeholder:"Title",required:!0}),(0,s.jsx)(h.J,{htmlFor:"composer",children:"Composer"}),(0,s.jsx)(f,{name:"composer",value:N.composer,onChange:_,placeholder:"Composer"}),(0,s.jsx)(h.J,{htmlFor:"year",children:"Year Composed"}),(0,s.jsxs)("select",{name:"year",value:(null===(e=N.year)||void 0===e?void 0:e.toString())||"",onChange:_,className:"w-full p-3 bg-white border rounded-md border-orange-200 focus:border-orange-500 focus:ring-2 focus:ring-orange-500 focus:outline-none",children:[(0,s.jsx)("option",{value:"",children:"Select Year"}),E.reverse().map(e=>(0,s.jsx)("option",{value:e,children:e},e))]}),(0,s.jsx)(h.J,{htmlFor:"lyrics",children:"Lyrics"}),(0,s.jsx)("textarea",{name:"lyrics",value:N.lyrics,onChange:_,placeholder:"Lyrics?",rows:3,className:"w-full p-3 border rounded-md border-orange-200 focus:border-orange-500 focus:ring-2 focus:ring-orange-500 focus:outline-none"}),(0,s.jsx)("div",{className:"border-2 border-dashed rounded-lg p-6 cursor-pointer\n              ".concat(t.length?"border-orange-500 bg-orange-50":"border-gray-300","\n              ").concat(z?"border-red-500 bg-red-50":"","\n              hover:border-orange-500 transition-colors"),onDrop:e=>{e.preventDefault(),F(Array.from(e.dataTransfer.files))},onDragOver:e=>e.preventDefault(),onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="application/pdf",e.onchange=e=>{let t=e.target;t.files&&F(Array.from(t.files))},e.click()},children:(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[t.length?(0,s.jsx)(c.A,{size:52,className:"text-orange-500"}):(0,s.jsx)(n.A,{size:52,className:"text-gray-400"}),(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("p",{className:"text-xl",children:t.length?"".concat(t.length," file selected"):"Drag a PDF file here or click to select"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Maximum file size: 5MB"})]})]})}),t.length>0&&(0,s.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-md",children:[(0,s.jsx)("span",{className:"text-sm text-gray-600",children:e.name}),(0,s.jsx)(g.$,{variant:"ghost",size:"sm",onClick:()=>{r([]),C(e=>({...e,file:null}))},children:(0,s.jsx)(i.A,{size:20})})]},t))}),(0,s.jsx)(h.J,{children:"Categories"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:p.map(e=>(0,s.jsx)(g.$,{type:"button",variant:N.categories.includes(e.name)?"default":"outline",onClick:()=>B(e.name),children:e.name},e.id))}),j?(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(f,{value:y,onChange:e=>b(e.target.value),placeholder:"Enter new category"}),(0,s.jsx)(g.$,{type:"button",onClick:()=>{y.trim()&&(C(e=>({...e,categories:[...e.categories,y.trim()]})),b(""),w(!1))},children:"Add"})]}):(0,s.jsxs)(g.$,{type:"button",variant:"link",onClick:()=>w(!0),className:"flex items-center gap-2 text-orange-600",children:[(0,s.jsx)(d.A,{size:16})," Add New Category"]}),N.categories.length>0&&(0,s.jsxs)("div",{className:"mt-2",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Selected categories:"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:N.categories.map(e=>(0,s.jsxs)("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-sm",children:[e,(0,s.jsx)(g.$,{variant:"ghost",size:"sm",onClick:()=>B(e),children:(0,s.jsx)(i.A,{size:14})})]},e))})]}),z&&(0,s.jsx)(m.Alert,{color:"red",title:"Error",children:z}),(0,s.jsx)(g.$,{type:"submit",disabled:A||!N.file||!N.title.trim(),className:"w-full",children:A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white mr-2"}),"Uploading..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{size:20,className:"mr-2"})," Upload"]})})]})})]})}},43608:(e,t,r)=>{"use strict";r.d(t,{UnstyledButton:()=>d});var s=r(95155);r(12115);var a=r(43664),o=r(53791),l=r(69604),n=r(64511),i={root:"m_87cf2631"};let c={__staticSelector:"UnstyledButton"},d=(0,n.polymorphicFactory)((e,t)=>{let r=(0,a.useProps)("UnstyledButton",c,e),{className:n,component:d="button",__staticSelector:u,unstyled:m,classNames:p,styles:f,style:g,...h}=r,x=(0,o.useStyles)({name:u,props:r,classes:i,className:n,style:g,classNames:p,styles:f,unstyled:m});return(0,s.jsx)(l.Box,{...x("root",{focusable:!0}),component:d,ref:t,type:"button"===d?"button":void 0,...h})});d.classes=i,d.displayName="@mantine/core/UnstyledButton"},59434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var s=r(52596),a=r(39688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},64173:(e,t,r)=>{"use strict";r.d(t,{useId:()=>n});var s=r(12115),a=r(73141),o=r(74275);let l=s["useId".toString()]||(()=>void 0);function n(e){let t=function(){let e=l();return e?"mantine-".concat(e.replace(/:/g,"")):""}(),[r,n]=(0,s.useState)(t);return((0,a.useIsomorphicEffect)(()=>{n((0,o.randomId)())},[]),"string"==typeof e)?e:"undefined"==typeof window?t:r}},64511:(e,t,r)=>{"use strict";r.d(t,{polymorphicFactory:()=>l});var s=r(95155),a=r(12115),o=r(36960);function l(e){let t=(0,a.forwardRef)(e);return t.withProps=e=>{let r=(0,a.forwardRef)((r,a)=>(0,s.jsx)(t,{...e,...r,ref:a}));return r.extend=t.extend,r.displayName="WithProps(".concat(t.displayName,")"),r},t.extend=o.D,t}},73141:(e,t,r)=>{"use strict";r.d(t,{useIsomorphicEffect:()=>a});var s=r(12115);let a="undefined"!=typeof document?s.useLayoutEffect:s.useEffect},74634:(e,t,r)=>{"use strict";r.d(t,{Alert:()=>g});var s=r(95155),a=r(64173);r(12115);var o=r(56204),l=r(68918),n=r(43664),i=r(53791),c=r(69604),d=r(36960),u=r(95642),m={root:"m_66836ed3",wrapper:"m_a5d60502",body:"m_667c2793",title:"m_6a03f287",label:"m_698f4f23",icon:"m_667f2a6a",message:"m_7fa78076",closeButton:"m_87f54839"};let p={},f=(0,l.createVarsResolver)((e,t)=>{let{radius:r,color:s,variant:a,autoContrast:l}=t,n=e.variantColorResolver({color:s||e.primaryColor,theme:e,variant:a||"light",autoContrast:l});return{root:{"--alert-radius":void 0===r?void 0:(0,o.getRadius)(r),"--alert-bg":s||a?n.background:void 0,"--alert-color":n.color,"--alert-bd":s||a?n.border:void 0}}}),g=(0,d.factory)((e,t)=>{let r=(0,n.useProps)("Alert",p,e),{classNames:o,className:l,style:d,styles:g,unstyled:h,vars:x,radius:v,color:y,title:b,children:j,id:w,icon:N,withCloseButton:C,onClose:k,closeButtonLabel:S,variant:A,autoContrast:z,..._}=r,F=(0,i.useStyles)({name:"Alert",classes:m,props:r,className:l,style:d,classNames:o,styles:g,unstyled:h,vars:x,varsResolver:f}),B=(0,a.useId)(w),E=b&&"".concat(B,"-title")||void 0,R="".concat(B,"-body");return(0,s.jsx)(c.Box,{id:B,...F("root",{variant:A}),variant:A,ref:t,..._,role:"alert","aria-describedby":R,"aria-labelledby":E,children:(0,s.jsxs)("div",{...F("wrapper"),children:[N&&(0,s.jsx)("div",{...F("icon"),children:N}),(0,s.jsxs)("div",{...F("body"),children:[b&&(0,s.jsx)("div",{...F("title"),"data-with-close-button":C||void 0,children:(0,s.jsx)("span",{id:E,...F("label"),children:b})}),j&&(0,s.jsx)("div",{id:R,...F("message"),"data-variant":A,children:j})]}),C&&(0,s.jsx)(u.CloseButton,{...F("closeButton"),onClick:k,variant:"transparent",size:16,iconSize:16,"aria-label":S,unstyled:h})]})})});g.classes=m,g.displayName="@mantine/core/Alert"},78100:(e,t,r)=>{Promise.resolve().then(r.bind(r,33273))},85057:(e,t,r)=>{"use strict";r.d(t,{J:()=>c});var s=r(95155),a=r(12115),o=r(40968),l=r(74466),n=r(59434);let i=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(o.b,{ref:t,className:(0,n.cn)(i(),r),...a})});c.displayName=o.b.displayName},95642:(e,t,r)=>{"use strict";r.d(t,{CloseButton:()=>g});var s=r(95155),a=r(5903);r(12115);var o=r(56204),l=r(68918),n=r(43664),i=r(53791),c=r(64511),d=r(43608),u=r(4146),m={root:"m_86a44da5","root--subtle":"m_220c80f2"};let p={variant:"subtle"},f=(0,l.createVarsResolver)((e,t)=>{let{size:r,radius:s,iconSize:l}=t;return{root:{"--cb-size":(0,o.getSize)(r,"cb-size"),"--cb-radius":void 0===s?void 0:(0,o.getRadius)(s),"--cb-icon-size":(0,a.D)(l)}}}),g=(0,c.polymorphicFactory)((e,t)=>{let r=(0,n.useProps)("CloseButton",p,e),{iconSize:a,children:o,vars:l,radius:c,className:g,classNames:h,style:x,styles:v,unstyled:y,"data-disabled":b,disabled:j,variant:w,icon:N,mod:C,__staticSelector:k,...S}=r,A=(0,i.useStyles)({name:k||"CloseButton",props:r,className:g,style:x,classes:m,classNames:h,styles:v,unstyled:y,vars:l,varsResolver:f});return(0,s.jsxs)(d.UnstyledButton,{ref:t,...S,unstyled:y,variant:w,disabled:j,mod:[{disabled:j||b},C],...A("root",{variant:w,active:!j&&!b}),children:[N||(0,s.jsx)(u.CloseIcon,{}),o]})});g.classes=m,g.displayName="@mantine/core/CloseButton"}},e=>{var t=t=>e(e.s=t);e.O(0,[560,144,181,441,684,358],()=>t(78100)),_N_E=e.O()}]);